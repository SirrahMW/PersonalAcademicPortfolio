__studentName__ = 'Harris McCall'
__professor__ = 'Matthew Boehnke'
__date__ = 'October 17, 2024'
__assignment__ = 'malware_spread'

import sys

def GetTime(p, n, r):
    # Day counter
    day = 1
    t = n + r # Initial num infected endpoints Day 1

    # While the number of infected devices is 
    # lower than the total number of devices
    while t < p:
        day += 1 # Another day, more infections
        t += r**day # Calculating the number of infections based on rate (r)

    # When the loop breaks, return the final values.
    return day, t

def main():
    # Input Validation
    if len(sys.argv) != 4: # There should only be 4 arguments
        print('Format should be: malware_spread <total # endpoints> <0 Day infections> <rate of infection>')
        sys.exit(1) # Close the program if arg # not met

    else:
        try:
            # Program name
            programName = sys.argv[0]
            # Program arguments
            numEndpoints = int(sys.argv[1])
            numInfectedDay0 = int(sys.argv[2])
            ratePerDay = int(sys.argv[3])

        # Exception for wrong input types.
        except ValueError:
            print('Error: Inputs must be integers.')

    # Find the day that all endpoints will be infected, 
    # and the potential number of infected devices if more were present
    exceededDay, excdeededCount = GetTime(numEndpoints, numInfectedDay0, ratePerDay)

    # Print results
    print('Running', programName, 'for', numEndpoints, 'endpoints with', numInfectedDay0, 'initially infected device(s) @ an infection rate of', ratePerDay, 'per day.')
    print('Exceeded day:', exceededDay)
    print('Exceeded count:', excdeededCount)

main()